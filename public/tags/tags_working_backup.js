    var tags=null;
    var tag_or_hash = null;
    var tag =[

                {
                    "userid": "9062",
                    "name": "A.T.M Golam Mostafa",
                    "email": "smucricmncsp@gmail.com",

                },
                {
                    "userid": "9082",
                    "name": "Abdur Rahman",
                    "email": "abdur.rahman@savethechildren.org"
                },
                {
                    "userid": "9090",
                    "name": "Abdur Rouf Sardar",
                    "email": "rouf.tasnim@gmail.com"
                },
                {
                    "userid": "99999",
                    "name": "Admin",
                    "email": "mohammad.shahed.chaklader@gmail.com"
                },
                {
                    "userid": "9016",
                    "name": "Afsana Karim",
                    "email": "afsana.karim@savethechildren.org"
                },
                {
                    "userid": "9058",
                    "name": "Altaf Hossen",
                    "email": "prucricmncsp@gmail.com"
                },
                {
                    "userid": "9092",
                    "name": "Anjuman Begum",
                    "email": "anjuman.begum@savethechildren.org"
                },
                {
                    "userid": "9041",
                    "name": "ANM Ehtesham Kabir",
                    "email": "ehtesham.kabir@savethechildren.org"
                },
                {
                    "userid": "9106",
                    "name": "Bhowmick, Jatan",
                    "email": "jatan.bhowmick@savethechildren.org"
                },
                {
                    "userid": "9029",
                    "name": "Bishwajit Kantho Dev",
                    "email": "shimantikmamonimncsp.cg@gmail.com"
                },
                {
                    "userid": "9031",
                    "name": "Biswajith Kumar Saha",
                    "email": "shimantikmamonimncsp.uc.nabiganj@gmail.com"
                },
                {
                    "userid": "9091",
                    "name": "Bivakar Roy",
                    "email": "bivakar.roy@savethechildren.org"
                },
                {
                    "userid": "9050",
                    "name": "Chameli Akter",
                    "email": "chamili.mncsp@psks-gm.org"
                },
                {
                    "userid": "9078",
                    "name": "Dibyendu Biswas",
                    "email": "dibbiswash.dascoh@gmail.com"
                },
                {
                    "userid": "9032",
                    "name": "Dilip Chandra Das",
                    "email": "shimantikmamonimncsp.mp@gmail.com"
                },
                {
                    "userid": "9075",
                    "name": "Dr. A. H. Md. Rezanur Shakil",
                    "email": "abu.shakil@savethechildren.org"
                },
                {
                    "userid": "9013",
                    "name": "Dr. Muntasir Moin Nabil",
                    "email": "mmoin@ihi.org"
                },
                {
                    "userid": "9053",
                    "name": "Dr. Utpal Kumar Barua",
                    "email": "utpal.barua@savethechildren.org"
                },
                {
                    "userid": "9051",
                    "name": "Faridul Julfiker",
                    "email": "faridul.julfiker@savethechildren.org"
                },
                {
                    "userid": "9094",
                    "name": "Faridul Zulfikar",
                    "email": "Faridul.Julfiker@savethechildren.org"
                },
                {
                    "userid": "269700",
                    "name": "Fazlur Rahman",
                    "email": "mfazlur.rahman@savethechildren.org"
                },
                {
                    "userid": "9026",
                    "name": "Feroj Al Mojahid",
                    "email": "feroj.mojahid@savethechildren.org"
                },
                {
                    "userid": "9065",
                    "name": "Harej Al-Mamun",
                    "email": "harej.almamun@savethechildren.org"
                },
                {
                    "userid": "9103",
                    "name": "Hossen, Iftekhar",
                    "email": "iftekhar.hossen@savethechildren.org"
                },
                {
                    "userid": "9084",
                    "name": "Husna Banu Rani",
                    "email": "rani.mncsp@psks-gm.org"
                },
                {
                    "userid": "9063",
                    "name": "Imrul Hasan",
                    "email": "dmmncspricnk@gmail.com"
                },
                {
                    "userid": "9019",
                    "name": "Ishrat Apa",
                    "email": "israt.nayer@savethechildren.org"
                },
                {
                    "userid": "260001",
                    "name": "Jamil Anwar Zaman",
                    "email": "jamil.zaman@savethechildren.org"
                },
                {
                    "userid": "260002",
                    "name": "Janel Gomej",
                    "email": "janel.gomes@savethechildren.org"
                },
                {
                    "userid": "9021",
                    "name": "Jesmin Akter",
                    "email": "jesminbl73@gmail.com"
                },
                {
                    "userid": "9057",
                    "name": "Kajal Kanto Das",
                    "email": "kajaldas3399@gmail.com"
                },
                {
                    "userid": "9017",
                    "name": "Kazi Md. Sofiul Kabir",
                    "email": "sofiul.shimantik@gmail.com"
                },
                {
                    "userid": "9028",
                    "name": "Kishor Mishra",
                    "email": "shimantikmamonimncsp.bania@gmail.com"
                },
                {
                    "userid": "9012",
                    "name": "Mamun Bhuyan",
                    "email": "mamun.bhuiyan@savethechildren.org"
                },
                {
                    "userid": "9007",
                    "name": "Matiar Rahman",
                    "email": "shimantikmamonimg@gmail.com"
                },
                {
                    "userid": "9067",
                    "name": "Maysa Tabassum",
                    "email": "mayesha.dascoh@gmail.com"
                },
                {
                    "userid": "9080",
                    "name": "Md Kamruzzaman",
                    "email": "kamruzzaman.dascoh@gmail.com"
                },
                {
                    "userid": "9096",
                    "name": "Md. Abdur Rahman",
                    "email": "abdur.rahman@savethechildren.org"
                },
                {
                    "userid": "9064",
                    "name": "MD. Abdur ROB PATWARY",
                    "email": "rmmncspric@gmail.com"
                },
                {
                    "userid": "9083",
                    "name": "Md. Abdus Salam",
                    "email": "salam.mncsp@psks-gm.org"
                },
                {
                    "userid": "9037",
                    "name": "Md. Abu Nausher Ali",
                    "email": "nausher_sumon@phd-bd.com"
                },
                {
                    "userid": "9047",
                    "name": "Md. Abul Kalam Azad",
                    "email": "azad.mncsp@psks-gm.org"
                },
                {
                    "userid": "9061",
                    "name": "Md. Ahsan Habib",
                    "email": "cgucricmncsp@gmail.com"
                },
                {
                    "userid": "9088",
                    "name": "Md. Alam Biswas",
                    "email": "alam.biswas80@gmail.com"
                },
                {
                    "userid": "9055",
                    "name": "Md. Antaz Uddin",
                    "email": "dmfeniric@gmail.com"
                },
                {
                    "userid": "9098",
                    "name": "Md. Ashraful Alam Mondul",
                    "email": "ashraf.mondul@gmail.com"
                },
                {
                    "userid": "9006",
                    "name": "Md. Azharul Islam",
                    "email": "shimantikmamonimncsp.ms@gmail.com"
                },
                {
                    "userid": "9038",
                    "name": "Md. Enamul Haque",
                    "email": "ucshibalayashimantik@gmail.com"
                },
                {
                    "userid": "9025",
                    "name": "Md. Feroz Kabir",
                    "email": "shimantikmamonibbdm@gmail.com"
                },
                {
                    "userid": "9104",
                    "name": "Md. Golam Mostafa",
                    "email": "golam.mostofa@savethechildren.org"
                },
                {
                    "userid": "9046",
                    "name": "Md. Imrul Hasan",
                    "email": "dmmncspricnk@gmail.com"
                },
                {
                    "userid": "9100",
                    "name": "Md. Jamal Uddin",
                    "email": "jamal.raj78@gmail.com"
                },
                {
                    "userid": "9099",
                    "name": "Md. Jamidul Islam",
                    "email": "jamidul.gangni@gmail.com"
                },
                {
                    "userid": "9071",
                    "name": "Md. Kamal Hossain",
                    "email": "kamalhossain.dascoh@gmail.com"
                },
                {
                    "userid": "9079",
                    "name": "Md. Khursidul Islam",
                    "email": "khurshidulislam.dascoh@gmail.com"
                },
                {
                    "userid": "9073",
                    "name": "Md. Mahmud Hassan Talukdar",
                    "email": "mahmud.talukdar@savethechildren.org"
                },
                {
                    "userid": "9093",
                    "name": "Md. Maksud-ul Hasan",
                    "email": "maksud.hasan@savethechildren.org"
                },
                {
                    "userid": "9101",
                    "name": "Md. Masuduzzaman",
                    "email": "masum069406@gmail.com"
                },
                {
                    "userid": "9054",
                    "name": "Md. Moktatherul Haque",
                    "email": "moktatherul.haque@savethechildren.org"
                },
                {
                    "userid": "9001",
                    "name": "Md. Murad Ahamed Khan",
                    "email": "murad.khan@savethechildren.org"
                },
                {
                    "userid": "9005",
                    "name": "Md. Nazrul Islam",
                    "email": "mdnazrul.islam@savethechildren.org"
                },
                {
                    "userid": "9070",
                    "name": "Md. Rafiqul Islam",
                    "email": "rafique.dascoh@gmail.com"
                },
                {
                    "userid": "9086",
                    "name": "Md. Shahidullah",
                    "email": "md.shahidullah@savethechildren.org"
                },
                {
                    "userid": "9033",
                    "name": "Md. Waliul Islam",
                    "email": "shimantikmamonimncsp.hg@gmail.com"
                },
                {
                    "userid": "9072",
                    "name": "Md. Zakir Hossain",
                    "email": "zakirhossain.dascoh@gmail.com"
                },
                {
                    "userid": "9024",
                    "name": "Md.Alamgir Hossain",
                    "email": "shimantikmamonimncsp.ng.uc@gmail.com"
                },
                {
                    "userid": "9008",
                    "name": "md.feroz akter"
                },
                {
                    "userid": "9023",
                    "name": "Md.Jalal Uddin",
                    "email": "shimantikmamonimncsp.nabi@gmail.com"
                },
                {
                    "userid": "9056",
                    "name": "Md.Rabiul Islam",
                    "email": "rabiul245@gmail.com"
                },
                {
                    "userid": "9048",
                    "name": "Md: Azahar Ali Miah",
                    "email": "ajahar.mncsp@psks-gm.org"
                },
                {
                    "userid": "9014",
                    "name": "Minara Chowdhury",
                    "email": "minara.chowdhury@savethechildren.org"
                },
                {
                    "userid": "9003",
                    "name": "Mohammad Mamun-Ur-Rashid",
                    "email": "mamun-ur.rashid@savethechildren.org"
                },
                {
                    "userid": "9081",
                    "name": "Mohammad Nurul Absar",
                    "email": "kbucricmncsp@gmail.com"
                },
                {
                    "userid": "9009",
                    "name": "Mohammad Rafique",
                    "email": "rafique7793@gmail.com"
                },
                {
                    "userid": "9066",
                    "name": "Mohammed Zahorul Islam",
                    "email": "zahirulislam.dascoh@gmail.com"
                },
                {
                    "userid": "9043",
                    "name": "Mohd. Aziz Khan",
                    "email": "aziz.khan@savethechildren.org"
                },
                {
                    "userid": "9020",
                    "name": "Moniruzzaman",
                    "email": "mohammed.moniruzzaman@savethechildren.org"
                },
                {
                    "userid": "9087",
                    "name": "Mostafa Qumrul Hassan",
                    "email": "qumrul.mncsp@psks-gm.org"
                },
                {
                    "userid": "9089",
                    "name": "Mrinal Kanti Sarkar",
                    "email": "mksarkar65@gmail.com"
                },
                {
                    "userid": "9102",
                    "name": "Mst. Mazeda Khatun",
                    "email": "mazidabogra@gmail.com"
                },
                {
                    "userid": "9002",
                    "name": "Nakul Kumar Biswas",
                    "email": "nakul.biswas@savethechildren.org"
                },
                {
                    "userid": "9015",
                    "name": "Nazmoon Nahar",
                    "email": "nazmoon.nahar@savethechildren.org"
                },
                {
                    "userid": "9069",
                    "name": "Nilu Kanto Paul",
                    "email": "dascoh.nilukanto@gmail.com"
                },
                {
                    "userid": "9068",
                    "name": "Nurul Alam",
                    "email": "nurulalam.dascoh@gmail.com"
                },
                {
                    "userid": "9097",
                    "name": "Parimal Saha",
                    "email": "parimal.shaha@savethechildren.org"
                },
                {
                    "userid": "9052",
                    "name": "Proshanta Kumar Mondal",
                    "email": "proshanta.mondal@savethechildren.org"
                },
                {
                    "userid": "9095",
                    "name": "Proshanta Kumar Mondal",
                    "email": "proshanta.mondal@savethechildren.org"
                },
                {
                    "userid": "269123",
                    "name": "Rima Pal",
                    "email": "rima.pal@savethechildren.org"
                },
                {
                    "userid": "9060",
                    "name": "Ripan Kumar Paul",
                    "email": "snucricmncsp@gmail.com"
                },
                {
                    "userid": "9035",
                    "name": "Roushan Ara Begum",
                    "email": "roushan.begum@savethechildren.org"
                },
                {
                    "userid": "9022",
                    "name": "S. M. Sabbir Ahammed",
                    "email": "shimantikmamonikasba@gmail.com"
                },
                {
                    "userid": "9027",
                    "name": "S.M. Rofiquzzaman",
                    "email": "shimantikmamonimncsp.aj@gmail.com"
                },
                {
                    "userid": "9049",
                    "name": "S.M.Harun-Or-Rashid",
                    "email": "harun.mncsp@psks-gm.org"
                },
                {
                    "userid": "9010",
                    "name": "Saha, Narayan",
                    "email": "narayan.saha@savethechildren.org"
                },
                {
                    "userid": "9018",
                    "name": "Sanjida Alam",
                    "email": "sanjida.alam@savethechildren.org"
                },
                {
                    "userid": "260000",
                    "name": "Shahed",
                    "email": "shahed.chaklader@savethechildren.org"
                },
                {
                    "userid": "9034",
                    "name": "Shakil Ahmed Khan",
                    "email": "shakil.khan@savethechildren.org"
                },
                {
                    "userid": "9074",
                    "name": "Shawkat Ara",
                    "email": "shawkat.ara@savethechildren.org"
                },
                {
                    "userid": "9059",
                    "name": "Sheikh Md. Abdul Khaleque",
                    "email": "scucricmncsp@gmail.com"
                },
                {
                    "userid": "9004",
                    "name": "Shumona Shafinaz",
                    "email": "shumona.shafinaz@savethechildren.org"
                },
                {
                    "userid": "9045",
                    "name": "Sujan Moy Chowdhury",
                    "email": "sujan.chowdhury@savethechildren.org"
                },
                {
                    "userid": "9085",
                    "name": "Sumon Kumar Biswas",
                    "email": "sumon.biswas@savethechildren.org"
                },
                {
                    "userid": "9105",
                    "name": "Syed Mirza Golam Hafiz",
                    "email": "htucricmncsp@gmail.com"
                },
                {
                    "userid": "9030",
                    "name": "Syed Salik Ahmed",
                    "email": "shimantikmamonimncsp.sd@gmail.com"
                },
                {
                    "userid": "261111",
                    "name": "system_mail",
                    "email": "mail@system.com"
                },
                {
                    "userid": "9040",
                    "name": "T A Robin",
                    "email": "ta.robin@savethechildren.org"
                },
                {
                    "userid": "9076",
                    "name": "Tangina Saharin Siddique",
                    "email": "tangina.siddique@savethechildren.org"
                },
                {
                    "userid": "9000",
                    "name": "Umme Salma Jahan Meena",
                    "email": "umme.meena@savethechildren.org"
                },
                {
                    "userid": "9077",
                    "name": "Wahiduzzaman",
                    "email": "wahiduzzaman.dascoh@gmail.com"
                },
                {
                    "userid": "9044",
                    "name": "Ziaur Rahman",
                    "email": "ziaur.rahman@savethechildren.org"
                }
    ];

    groups = [
        {
            "userid": "1",
            "name": "MNH",
            "email": ""
        },
        {
            "userid": "2",
            "name": "PI",
            "email": ""
        },
        {
            "userid": "3",
            "name": "Newborn",
            "email": ""
        },
        {
            "userid": "4",
            "name": "Operations",
            "email": ""
        },
        {
            "userid": "5",
            "name": "ICT Innovation",
            "email": ""
        }

    ];

    function load_tags(tags){

    //console.log(tags);

    //remove old values from list
    $("#tags ul").empty();

    //Add new element to list
    $.each(tags, function(i, v) {
        //if (v.name.search(new RegExp(/ja/i)) != -1) {
            $("#tags ul").append('<li data-email="'+v.email+'">'+v.name+'</li>');
        // }
    });

    // $("#tags").css({"top":$(".richText-editor").offset().top+50+"px", "left":$(".richText-editor").offset().left+20+"px"});
    $("#tags").css({"top":$("#issue-detail").offset().top+50+"px", "left":$("#issue-detail").offset().left+20+"px"});
    $("#tags").show();
}

    function search_in_json( keycode){
    //var regex = new RegExp(keycode, "i");

        if (keycode.length <1){
        hide_tags();
        return false;
    }

    temp = [];

    reg = keycode +"\\i";

    $.each(tags, function(i, v) {
        if (v.name.search(new RegExp(keycode,"i")) != -1) {
            //console.log(v.email);
            temp.push({"userid":v.userid, "name":v.name, "email": v.email});
        }
    });

    console.log(temp);
    load_tags(temp);

}

    function hide_tags(){
    $("#tags").hide();
}


    var trigger =0;
    var search_text ="";
    var caret=0;
    var all_txt = "";
    var first_part_before_caret = "";
    var last_part_after_caret = "";

    function reset_triggers() {
    //reset trigger and search text
    trigger =0;
    search_text ="";
}

    function split_text() {
    //all_txt = $(".richText-editor").html();
    all_txt = $("#issue-detail").text();
    first_part_before_caret = all_txt.substring(0,caret);
    last_part_after_caret = all_txt.substring(caret,all_txt.length);

    console.log("caret", caret);
    console.log(all_txt);
    console.log("first:", first_part_before_caret);
    console.log("last:",last_part_after_caret);
}



    $(document).ready(function() {
    //$('#rich').richText();

    //console.log(search_text);

    $("#issue-detail").on("keyup",function (e){
        console.log("page x:",e.keyCode);
        //Load Tags when pressed @=50 & #=51
        if(e.keyCode == 50 || e.keyCode == 51){

            if(e.keyCode == 50){
                tags= tag;
                tag_or_hash = "@";
            }
            else if(e.keyCode == 51){
                tags=groups;
                tag_or_hash = "#";
            }
            else{
                tags = null;
                tag_or_hash = null;
            }


            load_tags();

            //reset trigger and search text
            reset_triggers();

            //set caret of @
            caret = $('#issue-detail').caret();
            //caret = 10;

            //Split up the text of richtextbox
            split_text();

            trigger = 1;
            console.log("Caret pos:",caret);
            console.log("Tags",tags);
        }

        //hide tags when pressed space bar
        if(e.keyCode == 32){
            hide_tags();

            trigger =0;
            search_text ="";


        }

        //Adding new character to search text while typing
        if (trigger == 1)
        {
            if(e.keyCode != 50 && e.keyCode != 51 && e.keyCode != 32 && e.keyCode != 16 && e.keyCode != 8  )
            {
                search_text += String.fromCharCode(e.keyCode);
                search_in_json(search_text);
            }

            // When backspace is pressed
            if(e.keyCode == 8){
                search_text = search_text.substring(0, search_text.length-1);
                search_in_json(search_text);

            }

            //console.log("Search Text: ", search_text.length);
        }

    });

    $("#issue-detail").on("click",function (){
    hide_tags();
    reset_triggers();

    //cursorPos = $(".richText-editor");
    console.log("cursor pos:",$('.richText-editor').caret());

});


    //Click on suggestion list
    $(document).on("click","#tags ul li", function (){


        txt = first_part_before_caret;
        //txt += "<span style=\"background-color:#FF0;\">"+$(this).html()+"</span>&nbsp;";

        if(tag_or_hash == "@"){
            txt += "["+$(this).data('email')+"] ";

            //txt += "<span style=\"background-color:#FF0;\" data-email=\""+$(this).data('email')+"\">"+$(this).html()+"</span>&nbsp;";
        }

        if(tag_or_hash == "#"){
            txt += "["+$(this).html()+"] ";
        }

        txt += last_part_after_caret;

        //txt = $('.richText-editor') as  HTMLInputElement;

        console.log("Curser pos before concat:",caret);

        //$('#rich').val('');
        //$('.richText-editor').html('');
        //try{
        //$('#rich').insertText(' <span style="bakground-color:#FF0;">Shahed</span> ', caret);
        $('#issue-detail').html(txt);
        //$('.richText-editor').html($('#rich').val());

        $("#tags").hide();

        //}catch (e) {

        // }

        // $('.richText-editor').html(txt);

    });

    $(document).on("click","#issue-edit-detail",function (){
        alert('');
    })


});